<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clasificador de R√©gimen Macro-Financiero Argentina</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, rgba(20, 50, 40, 0.95) 0%, rgba(15, 35, 30, 0.95) 100%),
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><defs><pattern id="forest" x="0" y="0" width="120" height="120" patternUnits="userSpaceOnUse"><path d="M60,10 L70,40 L50,40 Z" fill="%23255040" opacity="0.3"/><path d="M30,30 L40,60 L20,60 Z" fill="%23204535" opacity="0.2"/><path d="M90,25 L100,55 L80,55 Z" fill="%23286050" opacity="0.25"/><circle cx="60" cy="80" r="15" fill="%23153530" opacity="0.2"/><circle cx="25" cy="90" r="12" fill="%231a4038" opacity="0.15"/><circle cx="95" cy="85" r="10" fill="%23204535" opacity="0.2"/></pattern></defs><rect width="1200" height="800" fill="url(%23forest)"/></svg>') center/cover;
            min-height: 100vh;
            padding: 20px;
        }

        /* LOGIN SCREEN STYLES */
        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-box {
            background: rgba(255, 255, 255, 0.98);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            max-width: 400px;
            width: 100%;
            border: 1px solid rgba(30, 70, 50, 0.2);
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-header h1 {
            color: #1e4d3c;
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .login-header .flag {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .login-header p {
            color: #666;
            font-size: 0.95em;
        }

        .login-input-group {
            margin-bottom: 20px;
        }

        .login-input-group label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .login-input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
        }

        .login-input-group input:focus {
            outline: none;
            border-color: #1e4d3c;
            box-shadow: 0 0 0 3px rgba(30, 77, 60, 0.15);
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #1e4d3c 0%, #153a2e 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 12px rgba(30, 77, 60, 0.3);
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(30, 77, 60, 0.5);
            background: linear-gradient(135deg, #245740 0%, #1a4534 100%);
        }

        .login-btn:active {
            transform: translateY(0);
        }

        .error-message {
            background: #fee;
            color: #c00;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 0.9em;
            display: none;
            border: 1px solid #fcc;
        }

        .error-message.show {
            display: block;
        }

        /* MAIN APP STYLES */
        .app-container {
            display: none;
        }

        .app-container.show {
            display: block;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            overflow: hidden;
            border: 1px solid rgba(30, 70, 50, 0.2);
        }

        .header {
            background: linear-gradient(135deg, #1e4d3c 0%, #153a2e 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 20px;
            right: 30px;
            width: 60px;
            height: 40px;
            background: linear-gradient(to bottom, 
                #74ACDF 0%, #74ACDF 33.33%, 
                white 33.33%, white 66.66%, 
                #74ACDF 66.66%, #74ACDF 100%);
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .header::after {
            content: '‚òÄÔ∏è';
            position: absolute;
            top: 30px;
            right: 46px;
            font-size: 18px;
            z-index: 1;
        }

        .logout-btn {
            position: absolute;
            top: 30px;
            left: 30px;
            padding: 8px 15px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .content {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 0;
        }

        .sidebar {
            background: linear-gradient(180deg, #f5f8f6 0%, #eef3ef 100%);
            padding: 30px;
            border-right: 1px solid #d0e0d5;
            max-height: calc(100vh - 200px);
            overflow-y: auto;
        }

        .main-content {
            padding: 30px;
            max-height: calc(100vh - 200px);
            overflow-y: auto;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #1e4d3c;
            box-shadow: 0 0 0 3px rgba(30, 77, 60, 0.15);
        }

        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #1e4d3c 0%, #153a2e 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 12px rgba(30, 77, 60, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(30, 77, 60, 0.5);
            background: linear-gradient(135deg, #245740 0%, #1a4534 100%);
        }

        .btn:active {
            transform: translateY(0);
        }

        .regime-card {
            background: linear-gradient(135deg, #1e4d3c 0%, #153a2e 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.25);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .regime-card h2 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .regime-card .probability {
            font-size: 3em;
            font-weight: bold;
            margin: 15px 0;
        }

        .probabilities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .prob-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #1e4d3c;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        .prob-card h3 {
            color: #333;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .prob-card .value {
            font-size: 2em;
            font-weight: bold;
            color: #1e4d3c;
        }

        .sector-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .sector-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border-top: 4px solid #1e4d3c;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            transition: transform 0.2s;
        }

        .sector-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(30, 77, 60, 0.15);
        }

        .sector-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .convexidad-bar {
            background: #f0f0f0;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
            position: relative;
        }

        .convexidad-fill {
            height: 100%;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            transition: width 0.5s ease;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .convexidad-fill.positive {
            background: linear-gradient(90deg, #2d6b4f 0%, #3d8b65 100%);
        }

        .convexidad-fill.negative {
            background: linear-gradient(90deg, #8b4d3d 0%, #a5624f 100%);
        }

        .rating {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
            margin-top: 10px;
        }

        .rating.muy-positivo {
            background: #2d6b4f;
            color: white;
        }

        .rating.positivo {
            background: #3d8b65;
            color: white;
        }

        .rating.neutral {
            background: #b8956a;
            color: white;
        }

        .rating.negativo {
            background: #8b6347;
            color: white;
        }

        .rating.muy-negativo {
            background: #8b4d3d;
            color: white;
        }

        .section-title {
            font-size: 1.5em;
            color: #1a3d30;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #1e4d3c;
        }

        .indicator-summary {
            background: linear-gradient(135deg, #f5f8f6 0%, #eef3ef 100%);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid #d0e0d5;
        }

        .indicator-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .indicator-row:last-child {
            border-bottom: none;
        }

        .indicator-label {
            font-weight: 600;
            color: #666;
        }

        .indicator-value {
            font-weight: bold;
            color: #333;
        }

        .last-update {
            text-align: center;
            color: #2d4a3c;
            font-size: 0.9em;
            padding: 15px;
            background: linear-gradient(135deg, #f5f8f6 0%, #eef3ef 100%);
            border-top: 1px solid #d0e0d5;
        }

        .disclaimer {
            background: #f5f8f6;
            border-left: 4px solid #2d6b4f;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
        }

        .disclaimer p {
            font-size: 0.85em;
            color: #2d4a3c;
            line-height: 1.5;
            margin: 0;
        }

        @media (max-width: 1024px) {
            .content {
                grid-template-columns: 1fr;
            }

            .sidebar {
                max-height: none;
                border-right: none;
                border-bottom: 1px solid #d0e0d5;
            }

            .header::before,
            .header::after {
                top: 10px;
                right: 15px;
            }

            .logout-btn {
                top: 15px;
                left: 15px;
                font-size: 0.8em;
                padding: 6px 12px;
            }
        }
    </style>
</head>
<body>
    <!-- LOGIN SCREEN -->
    <div class="login-container" id="loginScreen">
        <div class="login-box">
            <div class="login-header">
                <div class="flag">üá¶üá∑</div>
                <h1>Acceso Restringido</h1>
                <p>Sistema de Clasificaci√≥n de R√©gimen Macro-Financiero</p>
            </div>
            <div class="error-message" id="errorMessage">
                Usuario o contrase√±a incorrectos
            </div>
            <form onsubmit="handleLogin(event)">
                <div class="login-input-group">
                    <label>Usuario</label>
                    <input type="text" id="username" placeholder="Ingrese su usuario" required>
                </div>
                <div class="login-input-group">
                    <label>Contrase√±a</label>
                    <input type="password" id="password" placeholder="Ingrese su contrase√±a" required>
                </div>
                <button type="submit" class="login-btn">üîê Ingresar</button>
            </form>
            <div class="disclaimer" style="margin-top: 20px;">
                <p><strong>üîí Seguro:</strong> Tus credenciales son verificadas localmente. No se env√≠an a ning√∫n servidor.</p>
            </div>
        </div>
    </div>

    <!-- MAIN APP -->
    <div class="app-container" id="appContainer">
        <div class="container">
            <div class="header">
                <button class="logout-btn" onclick="logout()">‚Üê Salir</button>
                <h1>üá¶üá∑ Clasificador de R√©gimen Macro-Financiero</h1>
                <p>Sistema de an√°lisis probabil√≠stico para Argentina</p>
            </div>

            <div class="content">
                <div class="sidebar">
                    <h2 style="margin-bottom: 20px; color: #333;">Actualizar Indicadores</h2>
                    
                    <div class="input-group">
                        <label>Riesgo Pa√≠s (bps)</label>
                        <input type="number" id="riesgo_pais" step="1" value="650">
                    </div>

                    <div class="input-group">
                        <label>Brecha Cambiaria (%)</label>
                        <input type="number" id="brecha_cambiaria" step="0.1" value="12">
                    </div>

                    <div class="input-group">
                        <label>Reservas Netas (Miles de Millones USD)</label>
                        <input type="number" id="reservas_netas" step="0.1" value="8.2">
                    </div>

                    <div class="input-group">
                        <label>Inflaci√≥n Mensual (%)</label>
                        <input type="number" id="inflacion_mensual" step="0.1" value="2.4">
                    </div>

                    <div class="input-group">
                        <label>Balance Fiscal Primario (% PBI)</label>
                        <input type="number" id="balance_fiscal" step="0.1" value="1.2">
                    </div>

                    <button class="btn" onclick="calcularRegimen()">üîÑ Actualizar An√°lisis</button>

                    <div class="disclaimer">
                        <p>
                            <strong>üí° Nota:</strong> Los datos se guardan autom√°ticamente en tu navegador. Este sistema es puramente informativo y NO constituye recomendaci√≥n de inversi√≥n.
                        </p>
                    </div>
                </div>

                <div class="main-content">
                    <div id="results">
                        <div class="regime-card">
                            <h2>R√©gimen M√°s Probable</h2>
                            <div class="probability" id="main-regime-prob">--</div>
                            <h3 id="main-regime-name" style="font-size: 1.5em;">Esperando datos...</h3>
                        </div>

                        <div class="indicator-summary">
                            <h3 style="margin-bottom: 15px; color: #333;">üìä Indicadores Actuales</h3>
                            <div class="indicator-row">
                                <span class="indicator-label">Riesgo Pa√≠s</span>
                                <span class="indicator-value" id="display-riesgo">-- bps</span>
                            </div>
                            <div class="indicator-row">
                                <span class="indicator-label">Brecha Cambiaria</span>
                                <span class="indicator-value" id="display-brecha">-- %</span>
                            </div>
                            <div class="indicator-row">
                                <span class="indicator-label">Reservas Netas</span>
                                <span class="indicator-value" id="display-reservas">-- MM USD</span>
                            </div>
                            <div class="indicator-row">
                                <span class="indicator-label">Inflaci√≥n Mensual</span>
                                <span class="indicator-value" id="display-inflacion">-- %</span>
                            </div>
                            <div class="indicator-row">
                                <span class="indicator-label">Balance Fiscal</span>
                                <span class="indicator-value" id="display-fiscal">-- % PBI</span>
                            </div>
                        </div>

                        <h2 class="section-title">Distribuci√≥n de Probabilidades</h2>
                        <div class="probabilities-grid" id="probabilities-grid"></div>

                        <h2 class="section-title">An√°lisis por Sector (ordenados por Convexidad)</h2>
                        <div class="sector-grid" id="sector-grid"></div>
                    </div>
                </div>
            </div>

            <div class="last-update">
                <span id="last-update-time">√öltima actualizaci√≥n: Nunca</span>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // SISTEMA DE AUTENTICACI√ìN
        // ============================================
        
        // IMPORTANTE: Cambia estos valores por tus credenciales
        const VALID_CREDENTIALS = {
            'admin': 'argentina2025',
            'santiago': 'macro2025',
            // Agrega m√°s usuarios aqu√≠: 'usuario': 'contrase√±a'
        };

        function handleLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorMessage = document.getElementById('errorMessage');
            
            // Verificar credenciales
            if (VALID_CREDENTIALS[username] && VALID_CREDENTIALS[username] === password) {
                // Login exitoso
                sessionStorage.setItem('isAuthenticated', 'true');
                sessionStorage.setItem('currentUser', username);
                showApp();
            } else {
                // Login fallido
                errorMessage.classList.add('show');
                setTimeout(() => {
                    errorMessage.classList.remove('show');
                }, 3000);
            }
        }

        function showApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').classList.add('show');
            calcularRegimen(); // Calcular autom√°ticamente al entrar
        }

        function logout() {
            sessionStorage.removeItem('isAuthenticated');
            sessionStorage.removeItem('currentUser');
            document.getElementById('appContainer').classList.remove('show');
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        function checkAuth() {
            if (sessionStorage.getItem('isAuthenticated') === 'true') {
                showApp();
            }
        }

        // ============================================
        // L√ìGICA DEL CLASIFICADOR (IGUAL QUE ANTES)
        // ============================================

        const sectores = {
            'Energ√≠a Oil & Gas': {
                'Crisis Aguda': 0.6,
                'Estr√©s Severo': 0.4,
                'Estabilizaci√≥n': 0.3,
                'Normalizaci√≥n': 0.2,
                'Expansi√≥n': 0.1,
                'Recalentamiento': 0.3
            },
            'Energ√≠a Utilities': {
                'Crisis Aguda': -0.8,
                'Estr√©s Severo': -0.6,
                'Estabilizaci√≥n': 0.5,
                'Normalizaci√≥n': 0.7,
                'Expansi√≥n': 0.3,
                'Recalentamiento': -0.4
            },
            'Bancos': {
                'Crisis Aguda': -0.9,
                'Estr√©s Severo': -0.6,
                'Estabilizaci√≥n': 0.6,
                'Normalizaci√≥n': 0.8,
                'Expansi√≥n': 0.4,
                'Recalentamiento': -0.3
            },
            'Consumo Masivo': {
                'Crisis Aguda': -0.4,
                'Estr√©s Severo': -0.3,
                'Estabilizaci√≥n': 0.2,
                'Normalizaci√≥n': 0.5,
                'Expansi√≥n': 0.6,
                'Recalentamiento': 0.0
            },
            'Agroindustria': {
                'Crisis Aguda': 0.7,
                'Estr√©s Severo': 0.5,
                'Estabilizaci√≥n': 0.2,
                'Normalizaci√≥n': 0.1,
                'Expansi√≥n': 0.2,
                'Recalentamiento': 0.4
            },
            'Construcci√≥n e Inmobiliario': {
                'Crisis Aguda': -0.7,
                'Estr√©s Severo': -0.5,
                'Estabilizaci√≥n': 0.4,
                'Normalizaci√≥n': 0.7,
                'Expansi√≥n': 0.5,
                'Recalentamiento': -0.2
            },
            'Telecomunicaciones': {
                'Crisis Aguda': -0.3,
                'Estr√©s Severo': -0.2,
                'Estabilizaci√≥n': 0.1,
                'Normalizaci√≥n': 0.3,
                'Expansi√≥n': 0.4,
                'Recalentamiento': 0.0
            },
            'Acero e Industria': {
                'Crisis Aguda': -0.5,
                'Estr√©s Severo': -0.4,
                'Estabilizaci√≥n': 0.3,
                'Normalizaci√≥n': 0.5,
                'Expansi√≥n': 0.6,
                'Recalentamiento': -0.2
            },
            'Tecnolog√≠a y Conocimiento': {
                'Crisis Aguda': 0.4,
                'Estr√©s Severo': 0.3,
                'Estabilizaci√≥n': 0.2,
                'Normalizaci√≥n': 0.3,
                'Expansi√≥n': 0.4,
                'Recalentamiento': 0.2
            }
        };

        function clasificarRegimen(riesgoPais, brechaCambiaria, reservasNetas, inflacionMensual, balanceFiscal) {
            let scores = {
                'Crisis Aguda': 0,
                'Estr√©s Severo': 0,
                'Estabilizaci√≥n': 0,
                'Normalizaci√≥n': 0,
                'Expansi√≥n': 0,
                'Recalentamiento': 0
            };

            if (riesgoPais > 2000) {
                scores['Crisis Aguda'] += 5;
            } else if (riesgoPais > 1500) {
                scores['Crisis Aguda'] += 3;
                scores['Estr√©s Severo'] += 2;
            } else if (riesgoPais > 1000) {
                scores['Estr√©s Severo'] += 4;
                scores['Crisis Aguda'] += 1;
            } else if (riesgoPais > 600) {
                scores['Estr√©s Severo'] += 2;
                scores['Estabilizaci√≥n'] += 3;
            } else if (riesgoPais > 400) {
                scores['Estabilizaci√≥n'] += 3;
                scores['Normalizaci√≥n'] += 2;
            } else if (riesgoPais > 250) {
                scores['Normalizaci√≥n'] += 4;
                scores['Expansi√≥n'] += 1;
            } else {
                scores['Expansi√≥n'] += 3;
                scores['Normalizaci√≥n'] += 2;
            }

            if (brechaCambiaria > 100) {
                scores['Crisis Aguda'] += 5;
            } else if (brechaCambiaria > 50) {
                scores['Crisis Aguda'] += 2;
                scores['Estr√©s Severo'] += 3;
            } else if (brechaCambiaria > 30) {
                scores['Estr√©s Severo'] += 3;
                scores['Estabilizaci√≥n'] += 2;
            } else if (brechaCambiaria > 15) {
                scores['Estabilizaci√≥n'] += 3;
                scores['Estr√©s Severo'] += 1;
                scores['Normalizaci√≥n'] += 1;
            } else if (brechaCambiaria > 5) {
                scores['Normalizaci√≥n'] += 4;
                scores['Estabilizaci√≥n'] += 1;
            } else if (brechaCambiaria > -5) {
                scores['Normalizaci√≥n'] += 2;
                scores['Expansi√≥n'] += 3;
            } else {
                scores['Expansi√≥n'] += 2;
                scores['Recalentamiento'] += 3;
            }

            if (reservasNetas < -5) {
                scores['Crisis Aguda'] += 5;
            } else if (reservasNetas < 0) {
                scores['Crisis Aguda'] += 2;
                scores['Estr√©s Severo'] += 3;
            } else if (reservasNetas < 5) {
                scores['Estr√©s Severo'] += 3;
                scores['Estabilizaci√≥n'] += 2;
            } else if (reservasNetas < 15) {
                scores['Estabilizaci√≥n'] += 3;
                scores['Normalizaci√≥n'] += 2;
            } else if (reservasNetas < 30) {
                scores['Normalizaci√≥n'] += 4;
                scores['Expansi√≥n'] += 1;
            } else {
                scores['Expansi√≥n'] += 3;
                scores['Normalizaci√≥n'] += 2;
            }

            if (inflacionMensual > 25) {
                scores['Crisis Aguda'] += 4;
            } else if (inflacionMensual > 15) {
                scores['Crisis Aguda'] += 2;
                scores['Estr√©s Severo'] += 2;
            } else if (inflacionMensual > 10) {
                scores['Estr√©s Severo'] += 3;
                scores['Estabilizaci√≥n'] += 1;
            } else if (inflacionMensual > 5) {
                scores['Estabilizaci√≥n'] += 3;
                scores['Normalizaci√≥n'] += 1;
            } else if (inflacionMensual > 2) {
                scores['Normalizaci√≥n'] += 4;
            } else if (inflacionMensual > -1) {
                scores['Normalizaci√≥n'] += 2;
                scores['Expansi√≥n'] += 2;
            } else {
                scores['Expansi√≥n'] += 2;
                scores['Recalentamiento'] += 2;
            }

            if (balanceFiscal < -8) {
                scores['Crisis Aguda'] += 4;
            } else if (balanceFiscal < -5) {
                scores['Crisis Aguda'] += 2;
                scores['Estr√©s Severo'] += 2;
            } else if (balanceFiscal < -3) {
                scores['Estr√©s Severo'] += 3;
                scores['Estabilizaci√≥n'] += 1;
            } else if (balanceFiscal < -1) {
                scores['Estabilizaci√≥n'] += 2;
                scores['Normalizaci√≥n'] += 2;
            } else if (balanceFiscal < 1) {
                scores['Normalizaci√≥n'] += 3;
                scores['Estabilizaci√≥n'] += 1;
            } else if (balanceFiscal < 3) {
                scores['Normalizaci√≥n'] += 2;
                scores['Expansi√≥n'] += 2;
            } else {
                scores['Expansi√≥n'] += 3;
                scores['Normalizaci√≥n'] += 1;
            }

            const totalScore = Object.values(scores).reduce((a, b) => a + b, 0);
            let probabilities = {};
            for (let regime in scores) {
                probabilities[regime] = scores[regime] / totalScore;
            }

            return probabilities;
        }

        function getRatingClass(convexidad) {
            if (convexidad >= 0.5) return { class: 'muy-positivo', text: 'Muy Positivo' };
            if (convexidad >= 0.2) return { class: 'positivo', text: 'Positivo' };
            if (convexidad >= -0.2) return { class: 'neutral', text: 'Neutral' };
            if (convexidad >= -0.5) return { class: 'negativo', text: 'Negativo' };
            return { class: 'muy-negativo', text: 'Muy Negativo' };
        }

        function calcularRegimen() {
            document.getElementById('main-regime-name').textContent = 'Calculando...';
            document.getElementById('main-regime-prob').textContent = '...';
            
            const riesgoPais = parseFloat(document.getElementById('riesgo_pais').value);
            const brechaCambiaria = parseFloat(document.getElementById('brecha_cambiaria').value);
            const reservasNetas = parseFloat(document.getElementById('reservas_netas').value);
            const inflacionMensual = parseFloat(document.getElementById('inflacion_mensual').value);
            const balanceFiscal = parseFloat(document.getElementById('balance_fiscal').value);

            if (isNaN(riesgoPais) || isNaN(brechaCambiaria) || isNaN(reservasNetas) || 
                isNaN(inflacionMensual) || isNaN(balanceFiscal)) {
                document.getElementById('main-regime-name').textContent = 'Error: Verifica los datos ingresados';
                document.getElementById('main-regime-prob').textContent = '--';
                return;
            }

            const data = { riesgoPais, brechaCambiaria, reservasNetas, inflacionMensual, balanceFiscal, timestamp: new Date().toISOString() };
            localStorage.setItem('argentina_indicators', JSON.stringify(data));

            const probabilities = clasificarRegimen(riesgoPais, brechaCambiaria, reservasNetas, inflacionMensual, balanceFiscal);

            let maxProb = 0;
            let mainRegime = '';
            for (let regime in probabilities) {
                if (probabilities[regime] > maxProb) {
                    maxProb = probabilities[regime];
                    mainRegime = regime;
                }
            }

            document.getElementById('main-regime-name').textContent = mainRegime;
            document.getElementById('main-regime-prob').textContent = (maxProb * 100).toFixed(1) + '%';

            document.getElementById('display-riesgo').textContent = riesgoPais.toLocaleString('es-AR') + ' bps';
            document.getElementById('display-brecha').textContent = brechaCambiaria.toFixed(1) + ' %';
            document.getElementById('display-reservas').textContent = reservasNetas.toLocaleString('es-AR', {minimumFractionDigits: 1}) + ' MM USD';
            document.getElementById('display-inflacion').textContent = inflacionMensual.toFixed(1) + ' %';
            document.getElementById('display-fiscal').textContent = balanceFiscal.toFixed(1) + ' % PBI';

            const probGrid = document.getElementById('probabilities-grid');
            probGrid.innerHTML = '';
            
            const regimenOrder = Object.entries(probabilities)
                .sort((a, b) => b[1] - a[1]);
            
            for (let [regime, prob] of regimenOrder) {
                const probCard = document.createElement('div');
                probCard.className = 'prob-card';
                probCard.innerHTML = `
                    <h3>${regime}</h3>
                    <div class="value">${(prob * 100).toFixed(1)}%</div>
                `;
                probGrid.appendChild(probCard);
            }

            let sectoresConvexidad = [];
            for (let sector in sectores) {
                let expectedConvexidad = 0;
                for (let regime in probabilities) {
                    expectedConvexidad += sectores[sector][regime] * probabilities[regime];
                }
                sectoresConvexidad.push({
                    nombre: sector,
                    convexidad: expectedConvexidad
                });
            }

            sectoresConvexidad.sort((a, b) => b.convexidad - a.convexidad);

            const sectorGrid = document.getElementById('sector-grid');
            sectorGrid.innerHTML = '';
            
            for (let sectorData of sectoresConvexidad) {
                const rating = getRatingClass(sectorData.convexidad);
                const sectorCard = document.createElement('div');
                sectorCard.className = 'sector-card';
                
                const absConv = Math.abs(sectorData.convexidad);
                const maxWidth = 45;
                const barWidth = Math.min(absConv * 50, maxWidth);
                const isPositive = sectorData.convexidad >= 0;
                
                sectorCard.innerHTML = `
                    <h3>${sectorData.nombre}</h3>
                    <div class="convexidad-bar">
                        <div class="convexidad-fill ${isPositive ? 'positive' : 'negative'}" 
                             style="width: ${barWidth}%; ${isPositive ? 'left' : 'right'}: 50%;">
                            ${sectorData.convexidad.toFixed(2)}
                        </div>
                    </div>
                    <span class="rating ${rating.class}">${rating.text}</span>
                `;
                sectorGrid.appendChild(sectorCard);
            }

            document.getElementById('last-update-time').textContent = 
                '√öltima actualizaci√≥n: ' + new Date().toLocaleString('es-AR', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
        }

        window.onload = function() {
            checkAuth();
            
            const saved = localStorage.getItem('argentina_indicators');
            if (saved) {
                const data = JSON.parse(saved);
                document.getElementById('riesgo_pais').value = data.riesgoPais;
                document.getElementById('brecha_cambiaria').value = data.brechaCambiaria;
                document.getElementById('reservas_netas').value = data.reservasNetas;
                document.getElementById('inflacion_mensual').value = data.inflacionMensual;
                document.getElementById('balance_fiscal').value = data.balanceFiscal;
            }
        };
    </script>
</body>
</html>
